---
layout: post
title: "Workflows demystified"
date: 2011-10-08 07:38
comments: false
categories:
---

If you have ever worked on a project that involves building an <a  title="Application software" href="http://en.wikipedia.org/wiki/Application_software" rel="wikipedia">application</a> for a <a  title="Business process" href="http://en.wikipedia.org/wiki/Business_process" rel="wikipedia">business process</a>, then you definitely have heard of or used a <a  title="Workflow" href="http://en.wikipedia.org/wiki/Workflow" rel="wikipedia">workflow</a>. A workflow is nothing but a set of steps - with rules that <a  title="Definition" href="http://en.wikipedia.org/wiki/Definition" rel="wikipedia">define</a> which step comes after the current step, until you complete all the steps and the result is achieved. So, if you said go to the shop, get a notepad, do your homework on it, and then turn it in for review - that is a simple workflow. This one stops at submitting for review, but if I said that once you get the review result, then go and do something else - then we have added a step in between which requires someone to come in and manually review your work. This is still a workflow, but one that involves a manual approval step.

<div ><a href="http://www.flickr.com/photos/50698445@N03/4662457155"><img title="Business Process (EPC) in ARIS Express 3" src="http://farm2.static.flickr.com/1277/4662457155_fb39078799_m.jpg" alt="Business Process (EPC) in ARIS Express 3" /></a></div>

Workflows are used in any business critical application where one or more persons need to review or approve a certain business outcome that is generated by a software, or maybe something entered by the user and which needs to go into the application for processing or record keeping. Workflows are facilitated by software known as workflow engines like TIBCO iProcess etc.

In this post we will try to understand how these things work internally.
<h3>So what is a workflow and what does it look like?</h3>
Like I said before, workflow is a set of steps that need to be <a  title="Capital punishment" href="http://en.wikipedia.org/wiki/Capital_punishment" rel="wikipedia">executed</a> to achieve a business process. These steps can be automatic steps that get or set data in an application or a manual step which involves review and approval or user input.

The key components of a workflow are
<ul>
	<li>A set of independent and well defined steps or tasks that can be executed based on just the input parameters and no additional dependencies</li>
	<li>A set of rules that define the transitions from one step to another within the workflow</li>
	<li>An initial input that starts the fist step and a final place holder for the result.</li>
	<li>If there is a manual task, then clear instructions on how that task can be completed</li>
</ul>
<div>Once we define a workflow with these in mind, there needs to be some way of executing these workflows - execute them correctly, again and again and each time complete the flow. This is facilitated by a <a  title="Workflow engine" href="http://en.wikipedia.org/wiki/Workflow_engine" rel="wikipedia">workflow engine</a>.</div>
<div>The key components of a workflow engine are -</div>
<div>
<ul>
	<li>A way to define and store a workflow with both automatic and manual steps.</li>
	<li>A way to inspect and act upon the manual steps</li>
	<li>Logic to understand and implement the state transition between the steps</li>
	<li>A way to capture the output of each step and pass that as input to the next step</li>
	<li>In case of manual steps, a way to queue the tasks and pause execution until this manual step is executed.</li>
	<li>A state management mechanism which can tell at any given point the number of instances of that workflow being executed and the state of each flow - which step they are executing or which manual step the are waiting for to complete</li>
</ul>
<div>These are just a few of the many features of a workflow and workflow engine.</div>
</div>
<h3>So how are these things implemented anyway?</h3>
Commercial and <a  title="Open Source" href="http://www.wikinvest.com/concept/Open_Source" rel="wikinvest">Open Source</a> workflow engines are implemented in different programming languages with varying complexities. Many provide authentication and other additional features and some provide integration into other enterprise tools built by that vendor.

But generally, these do the following
<ul>
	<li>Provide a <a  title="Graphical user interface" href="http://en.wikipedia.org/wiki/Graphical_user_interface" rel="wikipedia">GUI</a> to define and store workflows - these workflows are stored as <a  title="XML" href="http://en.wikipedia.org/wiki/XML" rel="wikipedia">XML</a> or <a  title="Business Process Execution Language" href="http://en.wikipedia.org/wiki/Business_Process_Execution_Language" rel="wikipedia">BPEL</a> or some other proprietary formats</li>
	<li>They also provide the ability to choose and name how the intermediate state and results are stored</li>
	<li>They provide the ability to assign queues where tasks waiting for manual approval are put</li>
	<li>They also provide a GUI which can be used to inspect the manual tasks and review or approve them.</li>
	<li>They provide a way to define a hierarchy and assign tasks as per roles</li>
	<li>Some provide escalation mechanisms where if a certain task does not get completed in a certain time, then it gets flagged and raised to the next person in the hierarchy.</li>
</ul>
Apart from this these tools provide error handling to recover from issues and trigger correction flows and also admin functionalities to let technology teams manage the workflows better.

State management is generally achieved using a database.
<h3>What about runtime?</h3>
At runtime, it is just a matter of starting threads that monitor each input or queue and work through the tasks. The tasks need to be executed in the most efficient manner. There is generally no need for workflows to work super fast - as long as they correctly implement the business process its good enough.

Also, workflows work in co-ordination with different other enterprise systems - so it might not be possible to get things done unless that system responds.
<h3>What next?</h3>
This post has just been a theoretical explanation of workflows - in the next post we will try to build a simple workflow engine and get more insight into how it works.